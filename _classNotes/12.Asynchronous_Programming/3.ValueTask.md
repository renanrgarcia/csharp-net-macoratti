# ValueTask and ValueTask<T>

- Why use `ValueTask`?
  - `ValueTask` is a lightweight alternative to `Task` for scenarios where the result is often available synchronously.
  - `Task` and `Task<T>` are reference types and allocate memory on the heap, which can lead to performance overhead. Also uses Garbage Collection (GC), which can be expensive.
- `ValueTask` are value types (structs) and do not incur the same allocation overhead as `Task`.

## When to use `ValueTask`

- Use `ValueTask` when:
  - The result of the operation is often available synchronously.
  - You want to avoid the overhead of allocating a `Task` object.
  - When there is asynchronous scenario with a buffered result.
  - When the result is concluded synchronously.

## Example of `ValueTask`

```csharp
using System;
using System.Threading.Tasks;
class Program
{
    static async ValueTask<int> GetValueAsync(bool isSynchronous)
    {
        if (isSynchronous)
        {
            // Return a completed ValueTask with a result
            return 42;
        }
        else
        {
            // Simulate an asynchronous operation
            await Task.Delay(1000);
            return 84;
        }
    }

    static async Task Main(string[] args)
    {
        // Synchronous case
        ValueTask<int> syncResult = GetValueAsync(true);
        Console.WriteLine($"Synchronous result: {await syncResult}");

        // Asynchronous case
        ValueTask<int> asyncResult = GetValueAsync(false);
        Console.WriteLine($"Asynchronous result: {await asyncResult}");
    }
}
```
