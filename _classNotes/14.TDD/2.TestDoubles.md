# Test Doubles
- Test doubles are objects that replace real objects in a test environment. They are used to isolate the unit of work being tested and to control the behavior of dependencies.

## Types of Test Doubles
- **Dummy**: An object that is passed around but never actually used. It is usually just a placeholder.
- **Stub**: An object that provides predefined responses to method calls. It is used to control the behavior of dependencies in a test.
- **Spy**: An object that records information about the interactions with it, such as method calls and arguments. It can be used to verify that certain interactions occurred during the test.
- **Mock**: An object that is used to verify interactions between the unit under test and its dependencies. It can be used to assert that certain methods were called with specific arguments.
- **Fake**: An object that has a working implementation, but is not suitable for production. It is often used for testing purposes.

## Dummy Example
```csharp
public class DummyEmailService : IEmailService
{
    public void SendEmail(string to, string subject, string body)
    {
        // Do nothing
    }
}
```

## Stub Example
```csharp
public class StubUserRepository : IUserRepository
{
    public User GetUserById(int id)
    {
        return new User { Id = id, Name = "Test User" };
    }
}
```

## Spy Example
```csharp
public class SpyEmailService : IEmailService
{
    public List<string> SentEmails { get; } = new List<string>();

    public void SendEmail(string to, string subject, string body)
    {
        SentEmails.Add(to);
    }
}
```

## Mock Example
```csharp
public class MockUserRepository : IUserRepository
{
    public List<int> CalledWithIds { get; } = new List<int>();

    public User GetUserById(int id)
    {
        CalledWithIds.Add(id);
        return new User { Id = id, Name = "Mock User" };
    }

    public bool VerifyGetUserByIdCalledWith(int id)
    {
        return CalledWithIds.Contains(id);
    }
}
```

### Using built-in Mock<T>
```csharp
using Moq;

public class UserServiceTests
{
    [Fact]
    public void GetUser_ShouldCallGetUserById()
    {
        // Arrange
        var mockRepo = new Mock<IUserRepository>();
        var userService = new UserService(mockRepo.Object);

        // Act
        userService.GetUser(1);

        // Assert
        mockRepo.Verify(repo => repo.GetUserById(1), Times.Once);
    }
}
```

## Fake Example
```csharp
public class FakeUserRepository : IUserRepository
{
    private readonly List<User> _users = new List<User>();

    public User GetUserById(int id)
    {
        return _users.FirstOrDefault(u => u.Id == id);
    }

    public void AddUser(User user)
    {
        _users.Add(user);
    }
}
```

### Using Bogus to create fake data
```csharp
using Bogus;

public class UserFaker : Faker<User>
{
    public UserFaker()
    {
        RuleFor(u => u.Id, f => f.IndexFaker + 1);
        RuleFor(u => u.Name, f => f.Name.FullName());
    }
}
```
